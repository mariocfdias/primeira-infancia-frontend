<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Dashboard dos Municípios do Pacto Cearense da Primeira Infância">
    <title>Dashboard Municípios</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="mission-panorama.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:wght@400;700&display=swap" rel="stylesheet">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Adicionar header com navegação -->
    <header class="main-header">
        <div class="header-content">
            <div class="logo">
                <img src="public/logo-pacto.png" alt="Logo do Pacto Cearense da Primeira Infância">
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="index.html" class="active">Mapa Interativo</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="main-content">
        <div class="panels-wrapper">
            <!-- Left Panel -->
            <aside class="left-panel" role="complementary" aria-label="Navegação do mapa">
                <h1>Navegue pelos municípios</h1>
                <div class="select-wrapper">
                    <label for="municipios" class="visually-hidden">Selecione um município</label>
                    <select id="municipios" aria-label="Lista de municípios">
                        <option value="">Selecione um município</option>
                    </select>
                </div>
                <p class="helper-text" role="note">
                    Escolha um município no menu acima ou selecione diretamente no mapa para acessar o perfil do Pacto Cearense da Primeira Infância.
                </p>
                <div class="map-container" role="region" aria-label="Mapa do Ceará">
                    <div id="map" aria-label="Mapa interativo dos municípios"></div>
                </div>
                <div class="legenda" role="contentinfo">
                    <h2>Legenda</h2>
                    <p>
                        <span class="blue-square" role="img" aria-label="Indicador azul"></span>
                        Os campos destacados em azul representam os <b>municípios que participam do programa</b> Pacto Cearense da Primeira Infância.
                    </p>
                </div>
            </aside>

            <!-- Right Panel -->
            <section class="right-panel" role="region" aria-label="Informações do município">
                <!-- Section 1: Município Header -->
                <div class="nao-participante">
                    <i class="fas fa-info-circle"></i>
                    <p>Os resultados do município serão exibidos abaixo após a seleção.</p>
                </div>
                <article class="municipality-section skeleton-loading">
                    <div class="municipality-header">
                        <div class="municipality-image skeleton"></div>
                        <div class="municipality-info">
                            <div class="skeleton skeleton-text" style="width: 60%; height: 40px;"></div>
                            <div class="skeleton skeleton-text" style="width: 40%; height: 24px;"></div>
                            <div class="level-header">
                                <div class="skeleton skeleton-text" style="width: 30%; height: 24px;"></div>
                                <div class="skeleton skeleton-text" style="width: 20%; height: 24px;"></div>
                            </div>
                            <div class="progress-bar skeleton"></div>
                            <div class="skeleton skeleton-text" style="width: 50%; height: 16px;"></div>
                            <div class="stats">
                                <div class="stat-item pontos">
                                    <div class="icon-box skeleton"></div>
                                    <div class="stat-content">
                                        <div class="skeleton skeleton-text" style="width: 40px; height: 20px;"></div>
                                        <div class="skeleton skeleton-text" style="width: 60px; height: 14px;"></div>
                                    </div>
                                </div>
                                <div class="stat-item emblemas">
                                    <div class="icon-box skeleton"></div>
                                    <div class="stat-content">
                                        <div class="skeleton skeleton-text" style="width: 40px; height: 20px;"></div>
                                        <div class="skeleton skeleton-text" style="width: 60px; height: 14px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <!-- Section 2: Distintivos -->
                <article class="distintivos-section skeleton-loading">
                    <div class="skeleton skeleton-text" style="width: 40%; height: 24px; margin-bottom: 16px;"></div>
                    <div class="skeleton skeleton-text" style="width: 60%; height: 16px; margin-bottom: 24px;"></div>
                    <div class="distintivos-grid">
                        <div class="distintivo">
                            <div class="icon skeleton" style="width: 80px; height: 80px; border-radius: 50%;"></div>
                            <div class="skeleton skeleton-text" style="width: 80%; height: 16px; margin: 12px auto;"></div>
                        </div>
                        <div class="distintivo">
                            <div class="icon skeleton" style="width: 80px; height: 80px; border-radius: 50%;"></div>
                            <div class="skeleton skeleton-text" style="width: 80%; height: 16px; margin: 12px auto;"></div>
                        </div>
                        <div class="distintivo">
                            <div class="icon skeleton" style="width: 80px; height: 80px; border-radius: 50%;"></div>
                            <div class="skeleton skeleton-text" style="width: 80%; height: 16px; margin: 12px auto;"></div>
                        </div>
                    </div>
                </article>

                <!-- Section 3: Missões -->
                <article class="missoes-section skeleton-loading">
                    <div class="skeleton skeleton-text" style="width: 40%; height: 24px; margin-bottom: 16px;"></div>
                    <div class="skeleton skeleton-text" style="width: 60%; height: 16px; margin-bottom: 24px;"></div>
                    <div class="missao-list">
                        <!-- Missão Item Skeleton -->
                        <div class="missao-item">
                            <div class="missao-header">
                                <div class="missao-icon">
                                    <div class="icon-wrapper skeleton" style="width: 48px; height: 48px; border-radius: 50%;"></div>
                                </div>
                                <div class="missao-content">
                                    <div class="skeleton skeleton-text" style="width: 70%; height: 18px;"></div>
                                    <div class="skeleton skeleton-text" style="width: 90%; height: 16px;"></div>
                                </div>
                            </div>
                            <div class="evidence-section">
                                <div class="skeleton skeleton-text" style="width: 40%; height: 20px; margin-bottom: 12px;"></div>
                                <div class="skeleton skeleton-text" style="width: 60%; height: 16px; margin-bottom: 20px;"></div>
                                <div class="evidence-grid">
                                    <div class="evidence-item skeleton" style="height: 40px;"></div>
                                    <div class="evidence-item skeleton" style="height: 40px;"></div>
                                    <div class="evidence-item skeleton" style="height: 40px;"></div>
                                    <div class="evidence-item skeleton" style="height: 40px;"></div>
                                </div>
                                <div class="skeleton skeleton-button"></div>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
        </div>

        <!-- Mission Panorama Section -->
        <div class="panorama-container">
            <section id="panorama-missoes" class="panorama-section" role="region" aria-label="Panorama de Missões">
                <!-- O conteúdo será carregado dinamicamente pelo JavaScript -->
                <div class="loading-overlay">
                    <div class="loading-spinner"></div>
                </div>
                <div class="skeleton-content">
                    <div class="mission-cards-grid">
                        <div class="mission-card skeleton">
                            <div class="skeleton-text" style="width: 70%; height: 20px;"></div>
                            <div class="skeleton-text" style="width: 90%; height: 16px;"></div>
                            <div class="skeleton-text" style="width: 40%; height: 16px;"></div>
                            <div class="skeleton-button" style="width: 120px; height: 36px;"></div>
                        </div>
                        <div class="mission-card skeleton">
                            <div class="skeleton-text" style="width: 70%; height: 20px;"></div>
                            <div class="skeleton-text" style="width: 90%; height: 16px;"></div>
                            <div class="skeleton-text" style="width: 40%; height: 16px;"></div>
                            <div class="skeleton-button" style="width: 120px; height: 36px;"></div>
                        </div>
                        <div class="mission-card skeleton">
                            <div class="skeleton-text" style="width: 70%; height: 20px;"></div>
                            <div class="skeleton-text" style="width: 90%; height: 16px;"></div>
                            <div class="skeleton-text" style="width: 40%; height: 16px;"></div>
                            <div class="skeleton-button" style="width: 120px; height: 36px;"></div>
                        </div>
                        <div class="mission-card skeleton">
                            <div class="skeleton-text" style="width: 70%; height: 20px;"></div>
                            <div class="skeleton-text" style="width: 90%; height: 16px;"></div>
                            <div class="skeleton-text" style="width: 40%; height: 16px;"></div>
                            <div class="skeleton-button" style="width: 120px; height: 36px;"></div>
                        </div>
                        <div class="mission-card skeleton">
                            <div class="skeleton-text" style="width: 70%; height: 20px;"></div>
                            <div class="skeleton-text" style="width: 90%; height: 16px;"></div>
                            <div class="skeleton-text" style="width: 40%; height: 16px;"></div>
                            <div class="skeleton-button" style="width: 120px; height: 36px;"></div>
                        </div>
                        <div class="mission-card skeleton">
                            <div class="skeleton-text" style="width: 70%; height: 20px;"></div>
                            <div class="skeleton-text" style="width: 90%; height: 16px;"></div>
                            <div class="skeleton-text" style="width: 40%; height: 16px;"></div>
                            <div class="skeleton-button" style="width: 120px; height: 36px;"></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Nova seção de eventos -->
            <section id="eventos-section" class="eventos-section" role="region" aria-label="Eventos Recentes">
                <div class="eventos-header">
                    <h2>Quem está avançando?</h2>
                    <p class="eventos-description">
                        Veja as atualizações mais recentes sobre <span class="text-emphasis">missões concluídas</span> e <span class="text-emphasis">envio de evidências</span> pelas prefeituras <span class="text-emphasis">nos últimos 30 dias</span>.
                    </p>
                </div>

                <div class="eventos-filters">
                    <!-- Filtro de tipo de evento -->
                    <div class="filter-group tipo-evento-filter">
                        <label class="filter-label">Mostrando</label>
                        <div class="btn-group" role="group" aria-label="Tipo de Evento">
                            <input type="radio" class="btn-check" name="evento-tipo" id="todos-eventos" autocomplete="off" checked>
                            <label class="btn btn-outline-primary" for="todos-eventos">
                                <i class="fas fa-list me-1"></i> Todos os eventos
                            </label>
                            
                            <input type="radio" class="btn-check" name="evento-tipo" id="mission-completed" autocomplete="off">
                            <label class="btn btn-outline-primary" for="mission-completed">
                                <i class="fas fa-star me-1"></i> Missões concluídas
                            </label>
                            
                            <input type="radio" class="btn-check" name="evento-tipo" id="mission-started" autocomplete="off">
                            <label class="btn btn-outline-primary" for="mission-started">
                                <i class="fas fa-play-circle me-1"></i> Missões iniciadas
                            </label>
                        </div>
                    </div>

                    <!-- Filtro de município -->
                    <div class="filter-group municipio-filter">
                        <label class="filter-label" for="municipio-search">Município</label>
                        <input class="form-control" list="municipios-list" id="municipio-search" placeholder="Digite o nome do município">
                        <datalist id="municipios-list">
                            <!-- Será preenchido dinamicamente -->
                        </datalist>
                    </div>

                    <!-- Filtro de ordenação -->
                    <div class="filter-group order-filter">
                        <label class="filter-label" for="order-select">Ordenar por</label>
                        <div class="select-container">
                            <select class="form-select" id="order-select">
                                <option value="desc" selected>Mais recente</option>
                                <option value="asc">Mais antigo</option>
                            </select>
                            <span class="select-arrow"><i class="fas fa-chevron-down"></i></span>
                        </div>
                    </div>
                </div>

                <!-- Conteúdo dos eventos -->
                <div id="eventos-content" class="eventos-content">
                    <!-- Será preenchido dinamicamente -->
                    <div class="loading-overlay">
                        <div class="loading-spinner"></div>
                    </div>
                </div>

                <!-- Paginação -->
                <nav aria-label="Paginação de eventos" class="eventos-pagination">
                    <ul class="pagination justify-content-center">
                        <li class="page-item disabled">
                            <a class="page-link" href="#" aria-label="Anterior">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item">
                            <a class="page-link" href="#" aria-label="Próximo">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </section>
        </div>
    </div>

    <footer class="main-footer">
        <div class="footer-content">
            <p>&copy; 2023 Pacto Cearense da Primeira Infância. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
    <script src="data-loader.js"></script>
    <script src="mission-panorama.js"></script>
</body>
</html>